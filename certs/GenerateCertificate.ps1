# Create an expiery for the certificate.
$todaydt = Get-Date
$expiery = $todaydt.AddMonths(6)

# Generate the certificate.
$NewSelfSignedCertificateParameters = @{
    Subject = "CN=Air Signing Certificate"
    type = CodeSigningCert
    notafter = $expiery
    KeyAlgorithm = RSA
    KeyLength = 2048
    HashAlgorithm = SHA1
    FriendlyName = R3TestCertificate
    CertStoreLocation = Cert:\CurrentUser\My
}

$cert = New-SelfSignedCertificate $NewSelfSignedCertificateParameters

# Export the certificate as a pfx code signing key.
$password = Read-Host 'Choose a password for your key.' -AsSecureString
$fileOut = Join-Path $PSScriptRoot air-cert.p12
Export-PfxCertificate -Cert $cert -ChainOption BuildChain -Password $password -FilePath $fileOut

# Clean up the certificate from the Windows Certificate Store.
Get-ChildItem Cert:\CurrentUser\My |
Where-Object { $_.Thumbprint -match $cert.Thumbprint } |
Remove-Item

# SIG # Begin signature block
# MIIVaQYJKoZIhvcNAQcCoIIVWjCCFVYCAQExDzANBglghkgBZQMEAgEFADB5Bgor
# BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG
# KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCAwQXT+2l9vPmxg
# 75q3/I85SR0XkNl6Oaf3cSECQ8lGo6CCEKwwggNpMIICUaADAgECAhBHAdI3ecdg
# vkGGpG/BMAlaMA0GCSqGSIb3DQEBCwUAMDoxFDASBgNVBAMMC0FkYW0gQnJ5YW50
# MSIwIAYJKoZIhvcNAQkBFhNoZWxsb0BhZGFtYnJ5YW50LmNhMB4XDTIwMDQwNDA0
# MTM1NFoXDTIzMDQwNDA0MjM1NVowOjEUMBIGA1UEAwwLQWRhbSBCcnlhbnQxIjAg
# BgkqhkiG9w0BCQEWE2hlbGxvQGFkYW1icnlhbnQuY2EwggEiMA0GCSqGSIb3DQEB
# AQUAA4IBDwAwggEKAoIBAQCX1JVw+NmlLCkIa6/u67DkpdlRQ96+oJQJqXefSx83
# mSVOg3F0VJEjVdT1ZPbO4ikruvnyqoA2RGzlAiMxweE0tE7eR+m5G55wo1oQwFzi
# A94fJioKjEkJ7TeKkXVmsqrbnhwI5kdFU1+NkQ/F0RPVbYIHpEsI/eSNneLl2OAx
# SkWkoLuLcThuazxYW/oZyTWi0daZRjRyTp+LVwgBlK6G3QPy6TWAm8O17hSJDNID
# TpW65PuoK53qFo0baf5YVKoANc2e9FgRizMslqmD/jIpBZco7SNdeCGzVQwojrKJ
# 4iXxt77CXR7Th+9Qg4EKTQ5GxYHHaL+W5l7Hrja1Ye+FAgMBAAGjazBpMA4GA1Ud
# DwEB/wQEAwIHgDATBgNVHSUEDDAKBggrBgEFBQcDAzAjBgNVHREEHDAaghhmbGFz
# aGZsYXNocmV2b2x1dGlvbi5jb20wHQYDVR0OBBYEFJ+iLpZ+XBc6UaVa7GovUO1Y
# HxIOMA0GCSqGSIb3DQEBCwUAA4IBAQBesYPgcrXkbBIDa8ODSOhnQp/TkLIXpEh7
# LwNvL2WLr09b9Oc1yITlKszfTStwCvZ3CySrFPvX8Q5MrXi+YOQqlEhJds9oL+tH
# w1BOUVS7LpwSuxgyyPAc9JbMI3LqiiTWn4mql/UPrzRWdyGjY0o4H4hoEQoeGmSQ
# iFn0EaAkblpcKgN7e47lZFLkWJungNoXY0i757lxiSZor3ntH3EGeVvtq+Cqyy98
# Q86qq1KUmGkcaz0v1bMV4FkeANN221NNnNhXZKruJP/RHx2KXY4Eia8Lyz3q3L2b
# lmYr7/LMQlq94d0ptywQBeJd8a0Vct6lRl+CCZxqTWSZcdBP3N74MIIGajCCBVKg
# AwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkqhkiG9w0BAQUFADBiMQswCQYDVQQG
# EwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3d3cuZGlnaWNl
# cnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBBc3N1cmVkIElEIENBLTEwHhcNMTQx
# MDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBHMQswCQYDVQQGEwJVUzERMA8GA1UE
# ChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lDZXJ0IFRpbWVzdGFtcCBSZXNwb25k
# ZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCjZF38fLPggjXg4PbG
# KuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457VWmNbAklQ2YPOb2bu3cuF6V+l+dSH
# dIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2ULf1ErNzlgpno75hn67z/RJ4dQ6m
# WxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f4qi2LVkCYYhhchhoubh87ubnNC8x
# d4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/sjAw2W3rBerh4x8kGLkYQyI3oBGDb
# vHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lWMJPzyWHM0AjMa+xiQpGsAsDvpPCJ
# EY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8EBAMCB4AwDAYDVR0TAQH/BAIwADAW
# BgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8GA1UdIASCAbYwggGyMIIBoQYJYIZI
# AYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29t
# L0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIAQQBuAHkAIAB1AHMAZQAgAG8AZgAg
# AHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMAYQB0AGUAIABjAG8AbgBzAHQAaQB0
# AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4AYwBlACAAbwBmACAAdABoAGUAIABE
# AGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAAUwAgAGEAbgBkACAAdABoAGUAIABS
# AGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAAQQBnAHIAZQBlAG0AZQBuAHQAIAB3
# AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkAYQBiAGkAbABpAHQAeQAgAGEAbgBk
# ACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIAYQB0AGUAZAAgAGgAZQByAGUAaQBu
# ACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUALjALBglghkgBhv1sAxUwHwYDVR0j
# BBgwFoAUFQASKxOYspkH7R7for5XDStnAs0wHQYDVR0OBBYEFGFaTSS2STKdSip5
# GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSGMmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0
# LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEuY3JsMDigNqA0hjJodHRwOi8vY3Js
# NC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURDQS0xLmNybDB3BggrBgEF
# BQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBB
# BggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0
# QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcNAQEFBQADggEBAJ0lfhszTbImgVyb
# hs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xaFjkAneNshORaQPveBgGMN/qbsZ0k
# fv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVrNZAQoHuXx/Y/5+IRQaa9YtnwJz04
# HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420XEwbu5AO2FKvzj0OncZ0h3RTKFV2S
# Qdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPlVRbwuwqrHNtcSCdmyKOLChzlldqu
# xC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitrwlHCCkivsNRu4PQUCjob4489yq9q
# jXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt6gAK6z8nu7obMA0GCSqGSIb3DQEB
# BQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMxGTAXBgNV
# BAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNVBAMTG0RpZ2lDZXJ0IEFzc3VyZWQg
# SUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBaFw0yMTExMTAwMDAwMDBaMGIxCzAJ
# BgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5k
# aWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMTCC
# ASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAOiCLZn5ysJClaWAc0Bw0p5W
# VFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUkFcKYubR3SdyJxArar8tea+2tsHEx
# 6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiAfB6iD5IOUMnGh+s2P9gww/+m9/ui
# zW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLoOz3tsUGj7T++25VIxO4es/K8DCuZ
# 0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7SzgaurYRvSISbT0C58Uzyr5j79s5AXVz2
# qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+t9V3CidWfA9ipD8yFGCV/QcEogkC
# AwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIBhjA7BgNVHSUENDAyBggrBgEFBQcD
# AQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEFBQcDBAYIKwYBBQUHAwgwggHSBgNV
# HSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQwggGkMDoGCCsGAQUFBwIBFi5odHRw
# Oi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3BzLXJlcG9zaXRvcnkuaHRtMIIBZAYI
# KwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUAcwBlACAAbwBmACAAdABoAGkAcwAg
# AEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMAbwBuAHMAdABpAHQAdQB0AGUAcwAg
# AGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYAIAB0AGgAZQAgAEQAaQBnAGkAQwBl
# AHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQAIAB0AGgAZQAgAFIAZQBsAHkAaQBu
# AGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUAbQBlAG4AdAAgAHcAaABpAGMAaAAg
# AGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkAdAB5ACAAYQBuAGQAIABhAHIAZQAg
# AGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAAaABlAHIAZQBpAG4AIABiAHkAIABy
# AGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG/WwDFTASBgNVHRMBAf8ECDAGAQH/
# AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEFBQcwAYYYaHR0cDovL29jc3AuZGln
# aWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRwOi8vY2FjZXJ0cy5kaWdpY2VydC5j
# b20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3J0MIGBBgNVHR8EejB4MDqgOKA2
# hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290
# Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRB
# c3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQWBBQVABIrE5iymQftHt+ivlcNK2cC
# zTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYunpyGd823IDzANBgkqhkiG9w0BAQUF
# AAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUerVlx71Q0LQbPv7HUfdDjyslxhopyV
# w1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHruzaEd8wkpfMEGVWp5+Pnq2LN+4st
# kMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+SbOafE9c4deHaUJXPkKqvPnHZL7V/C
# SxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsHOE8Nxl2RuQ9nRc3Wg+3nkg2NsWmM
# T/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwKoO4sCFWFIrjrGBpN/CohrUkxg0eV
# d3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBBMwggQPAgEBME4wOjEUMBIGA1UEAwwL
# QWRhbSBCcnlhbnQxIjAgBgkqhkiG9w0BCQEWE2hlbGxvQGFkYW1icnlhbnQuY2EC
# EEcB0jd5x2C+QYakb8EwCVowDQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIB
# DDEKMAigAoAAoQKAADAZBgkqhkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEE
# AYI3AgELMQ4wDAYKKwYBBAGCNwIBFTAvBgkqhkiG9w0BCQQxIgQgfVvDzUUUZR14
# j6/R5/j/8IsAUHxAQBjkScdCH4Mpz2kwDQYJKoZIhvcNAQEBBQAEggEAcz1PvSXV
# l9LE6Ncbr2cRZFDinIhsXt+3bdhmIOMcplDHHmFtd+G2w3i7Pq6Omly/h5+noLwr
# /FgtBdl6d9TfDpPL+9CscLk9ce0/SJ9VgXIWglC6a5zfnGgbshyGAfYdNxBSAdN0
# ov8wKzjGSN0wJvP8DyB7jxY7cFnP5t86+C+TZVwoZuKMe8QXu8zRcc4jwQ5EB2os
# mPTc2t6vYTNoNknn+8oOuPF9DBNzyr797QdZIHpnp0hi0tZ+GhLBgzfo2AVI2CAj
# BuLN9So6GP+izojcgQT4VAC73pZbECBCWkSGQl10NgYezD5bIT1ob3L3abbj69lY
# j6xBGfz4o++H3qGCAg8wggILBgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJ
# BgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5k
# aWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQ
# AwGaAjr/WLFr1tXq5hfwZjAJBgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqG
# SIb3DQEHATAcBgkqhkiG9w0BCQUxDxcNMjAwNjMwMDE1OTMzWjAjBgkqhkiG9w0B
# CQQxFgQUdxHS7yp3Awb7JdaHJCm9QSfH48kwDQYJKoZIhvcNAQEBBQAEggEAZYIX
# vraqKp7Y6OrLwvUeeS6VxDcKRt2diZ8avFRHH94W1jBhtMWep1C16ud62kNglN3r
# LiNhokooq3jTM+wH6ddawUBcOVOfbiJ0tguJ1odEZHKfUPJx2GjvPoB7PnICmzjs
# AvZmYdRKgFtFSQp2FSRMbvuA3ZB1RGg7cp5i3bUbrd+r+OpCP3hPNw63uvaZK8DR
# 0/6OXuJWd6JaRvR3xyKMLL4tuIdHxCsmxx2as3M5NnGV25jRNWs3h3y7h8/FnfqC
# 03spAhqh9MRW31MRVX+hZrnR3pnjyA5CR/lgbfxslEVltvs+cE0HDucb6ilE2/+z
# nZ0gvhbzZWHnu4slMg==
# SIG # End signature block
